<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><style>body {
      margin: 0;
    }
    canvas {
      width: 100%;
      height: 100%;
    }
    #log {
      position: absolute;
      width: 100%;
      height: 140px;
      line-height: 140px;
      vertical-align: middle;
      text-align: center;
      font-family: Helvetica, Arial;
      font-size: 24pt;
      color: white;
      border: 1px solid lightgray;
      cursor: pointer;
    }</style></head><body><div id="log"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r79/three.min.js"></script><script></script><script>(function() {
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
			var renderer = new THREE.WebGLRenderer();
			var geometry = new THREE.BoxGeometry( 1, 1, 1 );
			var material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
			var cube = new THREE.Mesh( geometry, material );
      var webglCanvas = null;
      var vrDisplay = null;
      var count = 0;
      var logger = document.getElementById("log"); 

			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);
			scene.add( cube );
			camera.position.z = 5;
      renderer.render(scene, camera);
      webglCanvas = renderer.domElement;
      window.addEventListener("click", requestPresent, false);

      if (navigator.getVRDisplays) {
        navigator.getVRDisplays()
        .then(function(displays) {
          if (displays.length > 0) {
            vrDisplay = displays[displays.length - 1];
            log("Enter VR");
          } else {
            log("No VR display");
          }
        }, function () {
          log("getVRDisplays failed");
        });
      } else {
        log("VR not supported");
      }

      function requestPresent() {
        if (vrDisplay) {
          if (vrDisplay.capabilities.canPresent) {
            vrDisplay.requestPresent([{source: webglCanvas}])
            .then(function () {
              vrDisplay.requestAnimationFrame(onAnimationFrame);
            }, function () {
              log("requestPresent failed");
            });
          } else {
            log("!canPresent");
          }
        } else {
          window.requestAnimationFrame(onAnimationFrame);
        }
      }

      function onAnimationFrame() {
        if (count++ < 600) {
          log(count);
          cube.rotation.x += 0.1;
          cube.rotation.y += 0.1;
          renderer.render(scene, camera);
          if (vrDisplay) {
            vrDisplay.requestAnimationFrame(onAnimationFrame);
            if (vrDisplay.isPresenting) {
              vrDisplay.submitFrame();
            }
          } else {
            window.requestAnimationFrame(onAnimationFrame);
          }
        } else {
          if (vrDisplay) {
            vrDisplay.exitPresent()
            .then(function () {
            }, function () {
              log("exitPresent failed");
            });
          }
        }
      }

      function log(comment) {
        logger.textContent = comment; 
      } 
    })();</script></body></html>